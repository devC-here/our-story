<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Playfair+Display:ital@1&family=Noto+Nastaliq+Urdu:wght@400;700&display=swap" rel="stylesheet"/>
<title>Chapter 1 ğŸ’œ</title>
<style>
/* â”€â”€ RESET â”€â”€ */
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

html, body {
  width:100%; height:100%;
  overflow:hidden;
  background:#08001a;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-family:'Playfair Display', serif;
  color:#fff;
  touch-action:none;
}

/* â”€â”€ AURA â”€â”€ */
body::before {
  content:'';
  position:fixed; inset:-20%;
  background:
    radial-gradient(circle at 28% 38%, rgba(255,100,220,.18), transparent 42%),
    radial-gradient(circle at 72% 62%, rgba(160,50,255,.22), transparent 42%);
  animation:aura 16s ease-in-out infinite alternate;
  pointer-events:none;
}
@keyframes aura {
  from { transform:translateY(-18px) rotate(-1deg); }
  to   { transform:translateY(18px)  rotate( 1deg); }
}

/* â”€â”€ CHAPTER LABEL â”€â”€ */
.ch-label {
  font-family:'Dancing Script', cursive;
  font-size:clamp(.8rem, 3vw, 1rem);
  letter-spacing:4px;
  text-transform:uppercase;
  color:rgba(220,160,255,.5);
  margin-bottom:clamp(14px, 3vw, 22px);
  text-shadow:0 0 16px rgba(180,80,255,.4);
  animation:fadeUp 1.2s ease forwards;
}

/* â”€â”€ SLATE â”€â”€ */
#slate {
  position:relative;
  /* fluid sizing â€” looks great on both phone & desktop */
  width: min(92vw, 720px);
  height: min(58vw, 420px);
  /* minimum so it never gets too squished on tiny phones */
  min-height: 220px;
  border-radius: clamp(14px, 3vw, 22px);
  overflow:hidden;
  background:rgba(20,0,35,.7);
  box-shadow:
    0 0 80px rgba(200,80,255,.35),
    inset 0 0 50px rgba(200,80,255,.2),
    inset 0 0 120px rgba(255,150,230,.1);
  animation:fadeUp 1s ease .2s both;
}

#slate::after {
  content:'';
  position:absolute; inset:0;
  border-radius:inherit;
  box-shadow:0 0 50px rgba(255,100,255,.4);
  pointer-events:none;
  z-index:5;
}

/* â”€â”€ MESSAGE (hidden under frost) â”€â”€ */
#message {
  position:absolute; inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding: clamp(20px, 5vw, 48px);
  gap: clamp(12px, 3vw, 22px);
  z-index:1;
  opacity:0;
  transform:translateY(12px);
  transition: opacity 1.8s ease, transform 1.8s ease;
}
#message.show {
  opacity:1;
  transform:translateY(0);
}

/* main Urdu/Hindi line */
.msg-main {
  font-family:'Dancing Script', cursive;
  font-size: clamp(18px, 4.5vw, 42px);
  line-height:1.5;
  color:#ffd6ff;
  text-shadow:
    0 0 10px #ff99ff,
    0 0 28px #cc66ff,
    0 0 70px rgba(255,120,255,.55);
}

/* small sub-line */
.msg-sub {
  font-family:'Playfair Display', serif;
  font-style:italic;
  font-size: clamp(11px, 2.5vw, 18px);
  color:rgba(255,200,255,.55);
  letter-spacing:1px;
  text-shadow: 0 0 16px rgba(200,100,255,.4);
}

/* â”€â”€ HINT (shown before wiping) â”€â”€ */
#hint {
  position:absolute; inset:0;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding-bottom: clamp(14px, 3vw, 22px);
  z-index:3;
  pointer-events:none;
  transition: opacity 1s ease;
}
#hint span {
  font-family:'Playfair Display', serif;
  font-style:italic;
  font-size: clamp(10px, 2.5vw, 14px);
  color:rgba(255,255,255,.45);
  letter-spacing:1.5px;
  text-shadow:0 1px 8px rgba(0,0,0,.5);
  animation: pulse 2.5s ease-in-out infinite;
}
@keyframes pulse { 0%,100%{opacity:.45;} 50%{opacity:.9;} }
#hint.hidden { opacity:0; }

/* â”€â”€ CANVAS â”€â”€ */
canvas {
  position:absolute; inset:0;
  width:100%; height:100%;
  cursor:crosshair;
  z-index:2;
  touch-action:none;
}

/* â”€â”€ PARTICLES â”€â”€ */
.heart {
  position:absolute;
  color:#ff9de6;
  font-size: clamp(10px, 2vw, 15px);
  pointer-events:none;
  z-index:10;
  animation:heartRise 2.2s ease forwards;
  text-shadow:0 0 10px #ff66ff;
}
@keyframes heartRise {
  to { transform:translateY(-55px) scale(.5); opacity:0; }
}

.spark {
  position:absolute;
  width:3px; height:3px;
  border-radius:50%;
  background:#fff;
  pointer-events:none;
  z-index:10;
  box-shadow:0 0 8px #fff, 0 0 18px #ff99ff;
  animation:sparkFade 1.1s linear forwards;
}
@keyframes sparkFade {
  to { transform:translateY(-16px); opacity:0; }
}

/* â”€â”€ INSTRUCTION BELOW SLATE â”€â”€ */
.below-hint {
  margin-top: clamp(12px, 3vw, 20px);
  font-family:'Playfair Display', serif;
  font-style:italic;
  font-size: clamp(10px, 2.5vw, 13px);
  color:rgba(200,150,255,.4);
  letter-spacing:2px;
  animation:fadeUp 1.2s ease .6s both;
}

/* â”€â”€ SHARED ANIMATIONS â”€â”€ */
@keyframes fadeUp {
  from { opacity:0; transform:translateY(16px); }
  to   { opacity:1; transform:translateY(0); }
}
</style>
</head>
<body>

<div class="ch-label">Chapter I &nbsp;Â·&nbsp; ğŸ’œ</div>

<div id="slate">
  <!-- the message hiding under the frost -->
  <div id="message">
    <div class="msg-main">
      "Dekh ke aapki muskkurahat,<br/>
      hum hosh gava baithe, <br/>
      hum host mein aane hi wale the, <br/>
      aur aap fir muskura baithe... <br/.
    </div>
    <div class="msg-sub">â€” written for you, always</div>
  </div>

  <!-- swipe hint overlay -->
  <div id="hint">
    <span>âœ¦ &nbsp; swipe to reveal &nbsp; âœ¦</span>
  </div>

  <canvas id="frost"></canvas>
</div>

<div class="below-hint">wipe the frost to find what's underneath</div>

<script>
const canvas  = document.getElementById('frost');
const ctx     = canvas.getContext('2d');
const slate   = document.getElementById('slate');
const message = document.getElementById('message');
const hint    = document.getElementById('hint');

/* â”€â”€ RESIZE & REDRAW â”€â”€ */
function resizeCanvas() {
  const rect = slate.getBoundingClientRect();
  const dpr  = window.devicePixelRatio || 1;

  canvas.width  = rect.width  * dpr;
  canvas.height = rect.height * dpr;
  canvas.style.width  = rect.width  + 'px';
  canvas.style.height = rect.height + 'px';

  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  drawFrost(rect.width, rect.height);
}

function drawFrost(w, h) {
  ctx.globalCompositeOperation = 'source-over';

  /* base frost gradient */
  const g = ctx.createLinearGradient(0, 0, w, h);
  g.addColorStop(0, '#e8a8ff');
  g.addColorStop(.5,'#ffb8f0');
  g.addColorStop(1, '#c878ff');
  ctx.fillStyle = g;
  ctx.fillRect(0, 0, w, h);

  /* snow noise */
  for (let i = 0; i < 18000; i++) {
    ctx.fillStyle = 'rgba(255,255,255,' + (Math.random() * .28) + ')';
    ctx.fillRect(Math.random() * w, Math.random() * h, 1, 1);
  }

  /* frost crystal veins */
  ctx.strokeStyle = 'rgba(255,255,255,.18)';
  ctx.lineWidth = .8;
  for (let i = 0; i < 40; i++) {
    const sx = Math.random() * w;
    const sy = Math.random() * h;
    ctx.beginPath();
    ctx.moveTo(sx, sy);
    for (let j = 0; j < 4; j++) {
      ctx.lineTo(sx + (Math.random()-.5)*60, sy + (Math.random()-.5)*60);
    }
    ctx.stroke();
  }

  /* switch to erase mode */
  ctx.globalCompositeOperation = 'destination-out';
}

/* â”€â”€ WIPE â”€â”€ */
let cleared   = 0;
let hintGone  = false;
let revealed  = false;

function wipe(x, y) {
  /* wipe brush â€” bigger on desktop, comfortable on mobile */
  const radius = Math.min(canvas.width, canvas.height) * .085;

  const grad = ctx.createRadialGradient(x, y, radius * .18, x, y, radius);
  grad.addColorStop(0, 'rgba(0,0,0,1)');
  grad.addColorStop(.6,'rgba(0,0,0,.75)');
  grad.addColorStop(1, 'rgba(0,0,0,0)');

  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.arc(x, y, radius, 0, Math.PI * 2);
  ctx.fill();

  cleared++;
  spawnParticles(x, y);

  /* hide the "swipe to reveal" hint after first few strokes */
  if (!hintGone && cleared > 8) {
    hint.classList.add('hidden');
    hintGone = true;
  }

  /* reveal message after enough wiping */
  if (!revealed && cleared > 160) {
    revealed = true;
    message.classList.add('show');
    /* schedule the magical heart burst 15 seconds after reveal */
    setTimeout(launchHeartSequence, 10000);
  }
}

/* â”€â”€ PARTICLES â”€â”€ */
function spawnParticles(x, y) {
  if (Math.random() < .22) {
    const h = document.createElement('div');
    h.className = 'heart';
    h.textContent = ['â¤','ğŸ’œ','âœ¦'][Math.floor(Math.random()*3)];
    h.style.left = x + 'px';
    h.style.top  = y + 'px';
    slate.appendChild(h);
    setTimeout(() => h.remove(), 2200);
  }
  if (Math.random() < .32) {
    const s = document.createElement('div');
    s.className = 'spark';
    s.style.left = (x + (Math.random()-.5)*14) + 'px';
    s.style.top  = (y + (Math.random()-.5)*14) + 'px';
    slate.appendChild(s);
    setTimeout(() => s.remove(), 1200);
  }
}

/* â”€â”€ EVENTS â”€â”€ */
let isDown = false;
let lastX=0, lastY=0;

function getPos(e, rect) {
  if (e.touches) {
    return { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top };
  }
  return { x: e.clientX - rect.left, y: e.clientY - rect.top };
}

/* interpolate between last and current point for smooth wipe on fast swipes */
function interpolate(x1,y1,x2,y2) {
  const dist = Math.hypot(x2-x1, y2-y1);
  const steps = Math.max(1, Math.floor(dist/8));
  for (let i=0;i<=steps;i++) {
    wipe(x1+(x2-x1)*(i/steps), y1+(y2-y1)*(i/steps));
  }
}

canvas.addEventListener('mousedown', e => {
  isDown=true;
  const r=canvas.getBoundingClientRect();
  const p=getPos(e,r); lastX=p.x; lastY=p.y;
  wipe(p.x,p.y);
});
canvas.addEventListener('mouseup',   () => isDown=false);
canvas.addEventListener('mouseleave',() => isDown=false);
canvas.addEventListener('mousemove', e => {
  if(!isDown) return;
  const r=canvas.getBoundingClientRect();
  const p=getPos(e,r);
  interpolate(lastX,lastY,p.x,p.y);
  lastX=p.x; lastY=p.y;
});

canvas.addEventListener('touchstart', e => {
  e.preventDefault(); isDown=true;
  const r=canvas.getBoundingClientRect();
  const p=getPos(e,r); lastX=p.x; lastY=p.y;
  wipe(p.x,p.y);
}, {passive:false});
canvas.addEventListener('touchend',   e => { e.preventDefault(); isDown=false; }, {passive:false});
canvas.addEventListener('touchmove',  e => {
  e.preventDefault();
  if(!isDown) return;
  const r=canvas.getBoundingClientRect();
  const p=getPos(e,r);
  interpolate(lastX,lastY,p.x,p.y);
  lastX=p.x; lastY=p.y;
}, {passive:false});

/* â”€â”€ INIT â”€â”€ */
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEART FLOAT, GROW, QUESTION & BURST
   Triggers 10s after text is revealed
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function launchHeartSequence() {
  const layer = document.getElementById('burst-layer');

  /* â”€â”€ create the reddish-pink heart â”€â”€ */
  const heart = document.createElement('div');
  heart.id = 'big-heart';
  heart.textContent = 'â¤ï¸';
  heart.style.cssText = `
    position:fixed; left:50%; bottom:-110px;
    transform:translateX(-50%) scale(0.12);
    font-size:80px; pointer-events:none; z-index:999; opacity:0;
    will-change:transform,bottom,filter;
    filter:
      drop-shadow(0 0 20px rgba(255,50,110,.95))
      drop-shadow(0 0 50px rgba(255,70,130,.6))
      drop-shadow(0 0 90px rgba(255,30,90,.35));
  `;
  layer.appendChild(heart);

  /* â”€â”€ float up from bottom â”€â”€ */
  requestAnimationFrame(() => requestAnimationFrame(() => {
    heart.style.transition =
      'bottom 2.2s cubic-bezier(.22,.65,.28,1),' +
      'transform 2.2s cubic-bezier(.22,.65,.28,1),' +
      'opacity .55s ease';
    heart.style.opacity   = '1';
    heart.style.bottom    = '36%';
    heart.style.transform = 'translateX(-50%) scale(0.65)';
  }));

  /* â”€â”€ steady growing â€” runs the whole time â”€â”€ */
  let scale   = 0.65;
  let paused  = false;
  let done    = false;

  const growInt = setInterval(() => {
    if (paused || done) return;
    scale += 0.048;
    applyHeartStyle(heart, scale);

    /* at scale ~1.3 â†’ pause, show the question */
    if (scale >= 1.3 && !paused && !document.getElementById('love-question')) {
      paused = true;
      setTimeout(showQuestion, 350);
    }
  }, 80);

  window._growInt     = growInt;
  window._heartEl     = heart;
  window._heartLayer  = layer;

  /* called when she answers correctly */
  window._onCorrect = () => {
    done = true;
    clearInterval(growInt);
    /* fast ramp to burst */
    let sc = scale;
    const ramp = setInterval(() => {
      sc += 0.1;
      applyHeartStyle(heart, sc);
      if (sc >= 4.2) {
        clearInterval(ramp);
        triggerBurst(heart, layer);
      }
    }, 55);
  };
}

function applyHeartStyle(heart, scale) {
  const g = 20 + scale * 18;
  heart.style.transition = 'transform .08s linear, filter .08s linear';
  heart.style.transform  = `translateX(-50%) scale(${scale.toFixed(3)})`;
  heart.style.filter     = `
    drop-shadow(0 0 ${g}px rgba(255,50,110,.99))
    drop-shadow(0 0 ${g*2.4}px rgba(255,70,130,.75))
    drop-shadow(0 0 ${g*5}px rgba(255,30,90,.45))
  `;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUESTION CARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showQuestion() {
  const card = document.createElement('div');
  card.id = 'love-question';
  card.innerHTML = `
    <div class="lq-inner">
      <div class="lq-icon">ğŸ’Œ</div>
      <div class="lq-title">Before this heart burstsâ€¦</div>
      <div class="lq-q">In which month did we first talk?</div>
      <div class="lq-opts">
        <button class="lq-btn" onclick="pickAnswer(this,false)">March</button>
        <button class="lq-btn" onclick="pickAnswer(this,false)">April</button>
        <button class="lq-btn" onclick="pickAnswer(this,true)">June</button>
        <button class="lq-btn" onclick="pickAnswer(this,false)">August</button>
      </div>
      <div class="lq-hint" id="lq-hint">âœ¦ &nbsp; choose wisely &nbsp; âœ¦</div>
    </div>
  `;
  document.body.appendChild(card);
  /* animate in */
  requestAnimationFrame(() => requestAnimationFrame(() => {
    card.style.opacity = '1';
  }));
}

let wrongCount = 0;
function pickAnswer(btn, correct) {
  if (correct) {
    /* â”€â”€ CORRECT â”€â”€ */
    btn.classList.add('lq-correct');

    /* disable all buttons */
    document.querySelectorAll('.lq-btn').forEach(b => b.disabled = true);

    /* update hint text */
    const hint = document.getElementById('lq-hint');
    if (hint) hint.textContent = 'ğŸ’œ Yesâ€¦ that was the beginning of everything';

    /* fade card out then burst */
    const card = document.getElementById('love-question');
    setTimeout(() => {
      if (card) {
        card.style.transition = 'opacity .55s ease';
        card.style.opacity    = '0';
        setTimeout(() => { if(card) card.remove(); }, 580);
      }
      /* resume growth â†’ burst â†’ then advance chapter */
      if (window._onCorrect) window._onCorrect();
    }, 900);

  } else {
    /* â”€â”€ WRONG â”€â”€ */
    wrongCount++;
    btn.classList.add('lq-wrong');
    btn.disabled = true;

    /* heart throbs angry */
    const h = window._heartEl;
    if (h) {
      h.style.transition = 'filter .08s ease, transform .08s ease';
      h.style.filter = 'drop-shadow(0 0 90px rgba(255,0,40,1)) drop-shadow(0 0 160px rgba(255,0,60,.9)) brightness(1.4)';
      h.style.transform = `translateX(-50%) scale(${(parseFloat(h.style.transform.match(/scale\(([\d.]+)\)/)?.[1]||1)*1.18).toFixed(2)})`;
      setTimeout(() => { h.style.filter = ''; h.style.transform = h.style.transform; }, 350);
    }

    /* show "try again" nudge */
    const hint = document.getElementById('lq-hint');
    const msgs = [
      'Hmmâ€¦ think harder ğŸ’œ',
      'Not quiteâ€¦ you know this one ğŸ’—',
      'So closeâ€¦ one more try âœ¨',
    ];
    if (hint) hint.textContent = msgs[Math.min(wrongCount-1, msgs.length-1)];

    /* re-enable after a moment */
    setTimeout(() => btn.classList.remove('lq-wrong'), 650);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BURST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function triggerBurst(heart, layer) {
  const r  = heart.getBoundingClientRect();
  const cx = r.left + r.width  / 2;
  const cy = r.top  + r.height / 2;

  /* flash-expand â†’ vanish */
  heart.style.transition = 'transform .13s ease-out, opacity .13s ease-out, filter .13s ease-out';
  heart.style.transform  = 'translateX(-50%) scale(6)';
  heart.style.opacity    = '0';
  heart.style.filter     = 'drop-shadow(0 0 200px #fff) brightness(4)';
  setTimeout(() => heart.remove(), 180);

  /* 3 staggered shockwave rings */
  [0, 110, 240].forEach(d => setTimeout(() => addRing(cx, cy, layer), d));

  /* 160 glitter pieces */
  for (let i = 0; i < 160; i++) {
    setTimeout(() => addGlitter(cx, cy, layer), Math.random() * 200);
  }
  /* 50 emoji bursts */
  for (let i = 0; i < 50; i++) {
    setTimeout(() => addMiniHeart(cx, cy, layer), 40 + Math.random() * 280);
  }
  /* 16 evenly-spaced trails */
  for (let i = 0; i < 16; i++) addTrail(cx, cy, i * 22.5, layer, false);
  /* 8 longer diagonal trails */
  for (let i = 0; i < 8;  i++) addTrail(cx, cy, i * 45 + 11, layer, true);

  /* â”€â”€ advance to next chapter after burst settles â”€â”€ */
  setTimeout(() => {
    /* tell the parent (our-story.html) to move forward */
    try { window.parent.tryUnlockFromChapter(); } catch(e) {}
  }, 1800);
}

function addRing(cx, cy, layer) {
  const el = document.createElement('div');
  el.style.cssText = `
    position:fixed; left:${cx}px; top:${cy}px;
    width:14px; height:14px; margin:-7px 0 0 -7px;
    border-radius:50%; border:3px solid rgba(255,60,120,.95);
    pointer-events:none; z-index:998;
    animation:ringOut .75s ease-out forwards;
  `;
  layer.appendChild(el);
  setTimeout(() => el.remove(), 820);
}

function addGlitter(cx, cy, layer) {
  const colors = [
    '#ff4488','#ff6699','#ff99bb','#ffccdd',
    '#ff2255','#ee1166','#dd0055',
    '#ffffff','#ffe0ee','#ffb3cc',
    '#ffaa00','#ffe066','#cc44ff','#ff88ff'
  ];
  const color = colors[Math.floor(Math.random() * colors.length)];
  const size  = 3 + Math.random() * 10;
  const angle = Math.random() * 360;
  const dist  = 80 + Math.random() * 340;
  const tx    = Math.cos(angle * Math.PI/180) * dist;
  const ty    = Math.sin(angle * Math.PI/180) * dist - Math.random() * 80;
  const dur   = 900 + Math.random() * 1000;
  const rot   = Math.random() * 720 - 360;
  const type  = Math.floor(Math.random() * 4);

  const el = document.createElement('div');
  if (type === 2) {
    el.textContent = ['âœ¦','âœ§','â˜…','âœ¶','âœ¸'][Math.floor(Math.random()*5)];
    el.style.cssText = `
      position:fixed; left:${cx}px; top:${cy}px;
      font-size:${size*2.5}px; color:${color};
      text-shadow:0 0 ${size*3}px ${color},0 0 ${size*6}px ${color}88;
      pointer-events:none; z-index:997; line-height:1;
      animation:glitter ${dur}ms cubic-bezier(.2,.85,.4,1) forwards;
      --tx:${tx}px;--ty:${ty}px;--rot:${rot}deg;
    `;
  } else if (type === 3) {
    el.style.cssText = `
      position:fixed; left:${cx}px; top:${cy}px;
      width:${2+Math.random()*2}px; height:${size*3}px;
      background:linear-gradient(to bottom,${color},transparent);
      border-radius:2px; box-shadow:0 0 ${size}px ${color};
      pointer-events:none; z-index:997;
      animation:glitter ${dur}ms cubic-bezier(.2,.85,.4,1) forwards;
      --tx:${tx}px;--ty:${ty}px;--rot:${rot}deg;
    `;
  } else {
    el.style.cssText = `
      position:fixed; left:${cx}px; top:${cy}px;
      width:${size}px; height:${size}px;
      background:${color}; border-radius:${type===1?'2px':'50%'};
      ${type===1?'transform:rotate(45deg);':''}
      box-shadow:0 0 ${size*2}px ${color},0 0 ${size*5}px ${color}88;
      pointer-events:none; z-index:997;
      animation:glitter ${dur}ms cubic-bezier(.2,.85,.4,1) forwards;
      --tx:${tx}px;--ty:${ty}px;--rot:${rot}deg;
    `;
  }
  layer.appendChild(el);
  setTimeout(() => el.remove(), dur + 80);
}

function addMiniHeart(cx, cy, layer) {
  const emojis = ['â¤ï¸','ğŸ©·','ğŸ’—','ğŸ’–','ğŸ’','ğŸ’˜','ğŸ’•','âœ¨','ğŸ’«','ğŸŒŸ','â­','ğŸŒ¸','ğŸŒº','ğŸ€','ğŸ¦‹','ğŸ«§','ğŸ’','ğŸ’“','ğŸŒ·','ğŸ’'];
  const emoji  = emojis[Math.floor(Math.random() * emojis.length)];
  const angle  = Math.random() * 360;
  const dist   = 60 + Math.random() * 260;
  const tx     = Math.cos(angle * Math.PI/180) * dist;
  const ty     = Math.sin(angle * Math.PI/180) * dist - 60 - Math.random()*110;
  const size   = 16 + Math.random() * 28;
  const dur    = 1000 + Math.random() * 900;
  const el     = document.createElement('div');
  el.textContent = emoji;
  el.style.cssText = `
    position:fixed; left:${cx}px; top:${cy}px;
    font-size:${size}px; pointer-events:none; z-index:997; line-height:1;
    filter:drop-shadow(0 0 10px rgba(255,60,120,.9));
    animation:glitter ${dur}ms cubic-bezier(.12,.9,.3,1) ${Math.random()*220}ms forwards;
    --tx:${tx}px;--ty:${ty}px;--rot:${Math.random()*360-180}deg;
  `;
  layer.appendChild(el);
  setTimeout(() => el.remove(), dur+260);
}

function addTrail(cx, cy, angleDeg, layer, long) {
  const steps   = long ? 12 : 9;
  const maxDist = long ? 340 : 250;
  for (let i = 0; i < steps; i++) {
    setTimeout(() => {
      const el   = document.createElement('div');
      const prog = i / steps;
      const dist = 28 + prog * maxDist;
      const sp   = (Math.random()-.5) * 30;
      const tx   = Math.cos((angleDeg+sp) * Math.PI/180) * dist;
      const ty   = Math.sin((angleDeg+sp) * Math.PI/180) * dist;
      const sz   = Math.max(1.5,(long?9:7)-prog*6);
      const col  = i%2===0 ? '#ff6699' : '#ffffff';
      el.style.cssText = `
        position:fixed; left:${cx}px; top:${cy}px;
        width:${sz}px; height:${sz}px; border-radius:50%;
        background:${col};
        box-shadow:0 0 ${sz*3}px ${col},0 0 ${sz*7}px rgba(255,80,140,.7);
        pointer-events:none; z-index:996;
        animation:glitter ${480+prog*340}ms ease-out ${i*30}ms forwards;
        --tx:${tx}px;--ty:${ty}px;--rot:0deg;
      `;
      layer.appendChild(el);
      setTimeout(() => el.remove(), 1000);
    }, i*26);
  }
}
</script>

<!-- burst effects layer -->
<div id="burst-layer" style="position:fixed;inset:0;pointer-events:none;z-index:990;overflow:hidden;"></div>

<style>
@keyframes ringOut {
  from { width:14px; height:14px; margin:-7px 0 0 -7px; opacity:1; border-width:3px; }
  to   { width:400px; height:400px; margin:-200px 0 0 -200px; opacity:0; border-width:1px; }
}
@keyframes glitter {
  0%   { transform:translate(0,0) rotate(0deg) scale(1); opacity:1; }
  75%  { opacity:.9; }
  100% { transform:translate(var(--tx),var(--ty)) rotate(var(--rot)) scale(0); opacity:0; }
}

/* â•â• LOVE QUESTION CARD â•â• */
#love-question {
  position:fixed; inset:0; z-index:1000;
  display:flex; align-items:center; justify-content:center;
  padding:20px;
  background:rgba(6,0,16,.62);
  backdrop-filter:blur(8px);
  -webkit-backdrop-filter:blur(8px);
  opacity:0;
  transition:opacity .55s ease;
}
#love-question .lq-inner {
  background:rgba(22,0,40,.95);
  border:1px solid rgba(255,80,140,.32);
  border-radius:22px;
  padding:clamp(22px,5vw,42px) clamp(18px,5vw,42px);
  max-width:440px; width:100%;
  text-align:center;
  box-shadow:
    0 0 70px rgba(255,50,110,.22),
    0 30px 80px rgba(0,0,0,.55),
    inset 0 1px 0 rgba(255,120,160,.14);
  position:relative; overflow:hidden;
}
#love-question .lq-inner::before {
  content:'';
  position:absolute; top:0; left:0; right:0; height:3px;
  background:linear-gradient(to right,transparent,rgba(255,80,140,.85),transparent);
}
.lq-icon {
  font-size:clamp(30px,8vw,46px);
  margin-bottom:10px;
  display:block;
  animation:lqPulse 1.4s ease-in-out infinite;
}
@keyframes lqPulse { 0%,100%{transform:scale(1);} 50%{transform:scale(1.16);} }
.lq-title {
  font-family:'Dancing Script',cursive;
  font-size:clamp(1.05rem,4vw,1.45rem);
  color:rgba(255,175,205,.88);
  margin-bottom:8px;
  text-shadow:0 0 18px rgba(255,80,140,.5);
}
.lq-q {
  font-family:'Playfair Display',serif;
  font-style:italic;
  font-size:clamp(.95rem,3.5vw,1.25rem);
  color:#fff;
  margin-bottom:clamp(16px,4vw,26px);
  line-height:1.45;
  text-shadow:0 2px 14px rgba(255,80,140,.3);
}
.lq-opts {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-bottom:14px;
}
.lq-btn {
  padding:11px 8px;
  background:rgba(255,50,110,.1);
  border:1px solid rgba(255,80,140,.26);
  border-radius:11px; color:#fff;
  font-family:'Cormorant Garamond',serif;
  font-size:clamp(.88rem,3vw,1.05rem);
  cursor:pointer; transition:all .2s;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}
.lq-btn:not(:disabled):hover {
  background:rgba(255,50,110,.26);
  border-color:rgba(255,80,140,.6);
  transform:translateY(-2px);
}
.lq-btn:disabled { opacity:.45; cursor:default; }
.lq-wrong {
  border-color:#ff2244 !important;
  background:rgba(255,0,44,.22) !important;
  animation:wrongShake .38s ease;
}
.lq-correct {
  border-color:#66ffbb !important;
  background:rgba(0,200,110,.22) !important;
  animation:correctPop .3s ease;
}
@keyframes wrongShake {
  0%,100%{transform:translateX(0);}
  25%{transform:translateX(-7px);}
  75%{transform:translateX(7px);}
}
@keyframes correctPop {
  0%{transform:scale(1);}
  50%{transform:scale(1.08);}
  100%{transform:scale(1);}
}
.lq-hint {
  font-family:'Playfair Display',serif;
  font-style:italic;
  font-size:clamp(.68rem,2.5vw,.82rem);
  color:rgba(255,155,185,.5);
  letter-spacing:1.5px;
  min-height:1.4em;
  transition:color .3s ease;
  animation:lqPulse 2.2s ease-in-out infinite;
}
</style>
</body>
</html>
