<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 2 - Thoughts of You</title>
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Patrick+Hand&display=swap" rel="stylesheet">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  overflow: hidden;
  font-family: 'Patrick Hand', cursive;
  cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="%23ff9bb3" opacity="0.7"/><circle cx="12" cy="12" r="4" fill="%23ff6b9d"/></svg>'), auto;
  width: 100vw;
  height: 100vh;
  position: relative;
}

/* Background image */
.background {
  position: fixed;
  inset: 0;
  z-index: 0;
  background-image: url('1771777407215_image.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

/* Overlay for better contrast */
.overlay {
  position: fixed;
  inset: 0;
  z-index: 1;
  background: radial-gradient(
    ellipse at 50% 40%,
    rgba(255, 255, 255, 0.1) 0%,
    rgba(0, 0, 0, 0.05) 50%,
    transparent 100%
  );
  pointer-events: none;
}

/* Hearts container */
.hearts-container {
  position: fixed;
  inset: 0;
  z-index: 10;
  pointer-events: none;
}

/* Individual heart - thought bubble style */
.heart {
  position: absolute;
  cursor: pointer;
  pointer-events: all;
  filter: drop-shadow(0 4px 12px rgba(255, 182, 193, 0.5));
  transition: transform 0.15s ease, filter 0.15s ease;
}

.heart:hover {
  transform: scale(1.2);
  filter: drop-shadow(0 6px 16px rgba(255, 107, 157, 0.7));
}

.heart svg {
  display: block;
}

/* Heart pop animation */
.heart.popped {
  pointer-events: none;
  animation: heartPop 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

@keyframes heartPop {
  0% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
  30% {
    transform: scale(1.5) rotate(15deg);
    opacity: 0.9;
  }
  70% {
    transform: scale(1.3) rotate(-10deg);
    opacity: 0.5;
  }
  100% {
    transform: scale(0) rotate(45deg);
    opacity: 0;
  }
}

/* Heart fade out (when not popped) */
.heart.faded {
  pointer-events: none;
  animation: heartFadeOut 1s ease forwards;
}

@keyframes heartFadeOut {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(0.3);
  }
}

/* Revealed letters */
.letter-revealed {
  position: fixed;
  font-family: 'Caveat', cursive;
  font-size: 90px;
  font-weight: 700;
  color: #ff6b9d;
  text-shadow: 
    3px 3px 0 #fff,
    -3px -3px 0 #fff,
    3px -3px 0 #fff,
    -3px 3px 0 #fff,
    5px 5px 15px rgba(255, 107, 157, 0.6);
  z-index: 20;
  animation: letterAppear 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  pointer-events: none;
  transform-origin: center;
}

@keyframes letterAppear {
  0% {
    transform: scale(0) rotate(-180deg);
    opacity: 0;
  }
  50% {
    transform: scale(1.3) rotate(10deg);
    opacity: 1;
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

/* Instruction text */
.instruction {
  position: fixed;
  top: 15%;
  left: 50%;
  transform: translateX(-50%);
  font-family: 'Caveat', cursive;
  font-size: 38px;
  font-weight: 700;
  color: #ff6b9d;
  text-align: center;
  text-shadow: 
    3px 3px 0 #fff,
    -3px -3px 0 #fff,
    3px -3px 0 #fff,
    -3px 3px 0 #fff,
    5px 5px 20px rgba(255, 182, 193, 0.8);
  z-index: 25;
  animation: instructionPulse 2.5s ease-in-out infinite;
  pointer-events: none;
  max-width: 90%;
}

@keyframes instructionPulse {
  0%, 100% {
    opacity: 0.85;
    transform: translateX(-50%) scale(1);
  }
  50% {
    opacity: 1;
    transform: translateX(-50%) scale(1.08);
  }
}

.instruction.hidden {
  animation: instructionFadeOut 0.5s ease forwards;
}

@keyframes instructionFadeOut {
  to {
    opacity: 0;
    transform: translateX(-50%) scale(0.8);
  }
}

/* Particle effects */
.particle {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 15;
}

.particle.sparkle {
  background: radial-gradient(circle, #ffd700 0%, #ffed4e 50%, transparent 100%);
  box-shadow: 0 0 10px #ffd700;
}

.particle.heart-fragment {
  background: #ff6b9d;
}

/* Shimmer effect on letters */
@keyframes shimmer {
  0%, 100% {
    text-shadow: 
      3px 3px 0 #fff,
      -3px -3px 0 #fff,
      3px -3px 0 #fff,
      -3px 3px 0 #fff,
      5px 5px 15px rgba(255, 107, 157, 0.6);
  }
  50% {
    text-shadow: 
      3px 3px 0 #fff,
      -3px -3px 0 #fff,
      3px -3px 0 #fff,
      -3px 3px 0 #fff,
      5px 5px 25px rgba(255, 182, 193, 1),
      0 0 30px rgba(255, 107, 157, 0.8);
  }
}

.letter-revealed.shimmer {
  animation: letterAppear 1s cubic-bezier(0.175, 0.885, 0.32, 1.275), 
             shimmer 2s ease-in-out infinite 1s;
}

/* Completion message */
.completion-message {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  font-family: 'Caveat', cursive;
  font-size: 50px;
  font-weight: 700;
  color: #ff6b9d;
  text-align: center;
  text-shadow: 
    3px 3px 0 #fff,
    -3px -3px 0 #fff,
    3px -3px 0 #fff,
    -3px 3px 0 #fff,
    5px 5px 20px rgba(255, 107, 157, 0.8);
  z-index: 30;
  pointer-events: none;
  opacity: 0;
  line-height: 1.6;
}

.completion-message.show {
  animation: completionShow 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

@keyframes completionShow {
  0% {
    transform: translate(-50%, -50%) scale(0) rotate(-15deg);
    opacity: 0;
  }
  70% {
    transform: translate(-50%, -50%) scale(1.15) rotate(5deg);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(1) rotate(0deg);
    opacity: 1;
  }
}

/* Glow effect */
.glow {
  position: fixed;
  width: 200px;
  height: 200px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255, 182, 193, 0.4) 0%, transparent 70%);
  pointer-events: none;
  z-index: 5;
  animation: glowPulse 3s ease-in-out infinite;
}

@keyframes glowPulse {
  0%, 100% {
    opacity: 0.3;
    transform: scale(1);
  }
  50% {
    opacity: 0.6;
    transform: scale(1.2);
  }
}

/* Loading indicator */
.loading {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: 'Caveat', cursive;
  font-size: 32px;
  color: #ff6b9d;
  text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
  z-index: 100;
}

.loading.hidden {
  display: none;
}
</style>
</head>
<body>

<!-- Background -->
<div class="background"></div>
<div class="overlay"></div>

<!-- Glow effects near the boy's head -->
<div class="glow" style="top: 28%; left: 48%;"></div>

<!-- Loading indicator -->
<div class="loading" id="loading">Loading magic... âœ¨</div>

<!-- Hearts container -->
<div class="hearts-container" id="hearts-container"></div>

<!-- Instruction -->
<div class="instruction" id="instruction">
  Pop his thoughts! ðŸ’­ðŸ’œ
</div>

<!-- Completion message -->
<div class="completion-message" id="completion-message">
  His heart speaks! ðŸ’•
</div>

<script>
const heartsContainer = document.getElementById('hearts-container');
const instruction = document.getElementById('instruction');
const completionMessage = document.getElementById('completion-message');
const loading = document.getElementById('loading');

// Hide loading after a moment
setTimeout(() => {
  loading.classList.add('hidden');
}, 500);

// Message to reveal
const message = ['I', ' ', 'L', 'O', 'V', 'E', ' ', 'Y', 'O', 'U'];
let currentLetterIndex = 0;

// Letter positions on screen (arranged to spell out the message naturally)
const letterPositions = [
  { x: 25, y: 48 },  // I
  { x: 32, y: 48 },  // (space)
  { x: 36, y: 45 },  // L
  { x: 42, y: 43 },  // O
  { x: 50, y: 42 },  // V
  { x: 58, y: 43 },  // E
  { x: 65, y: 45 },  // (space)
  { x: 68, y: 48 },  // Y
  { x: 73, y: 50 },  // O
  { x: 78, y: 52 }   // U
];

// Heart colors - soft pastels matching the Ghibli aesthetic
const heartColors = [
  'rgba(255, 182, 193, 0.95)',  // Light pink
  'rgba(255, 160, 180, 0.95)',  // Soft pink
  'rgba(255, 192, 203, 0.95)',  // Pink
  'rgba(255, 218, 224, 0.95)',  // Pale pink
  'rgba(255, 204, 213, 0.95)'   // Rose pink
];

// Create SVG heart with gradient
function createHeartSVG(size, color) {
  const gradientId = 'gradient-' + Math.random().toString(36).substr(2, 9);
  return `
    <svg width="${size}" height="${size}" viewBox="0 0 24 24">
      <defs>
        <radialGradient id="${gradientId}" cx="50%" cy="50%" r="50%">
          <stop offset="0%" style="stop-color:${color};stop-opacity:1" />
          <stop offset="100%" style="stop-color:${color};stop-opacity:0.7" />
        </radialGradient>
      </defs>
      <path fill="url(#${gradientId})" stroke="rgba(255, 107, 157, 0.3)" stroke-width="0.5"
        d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
    </svg>
  `;
}

// Create a thought-heart floating from boy's mind
function createHeart() {
  const heart = document.createElement('div');
  heart.className = 'heart';
  
  // Start position - near the boy's head (around his mind)
  const startX = 47 + (Math.random() - 0.5) * 6; // Small random variation
  const startY = 25 + Math.random() * 3;
  
  // Size progression - hearts start tiny and grow
  const progress = Math.random();
  const minSize = 15;
  const maxSize = 50;
  const size = minSize + progress * (maxSize - minSize);
  
  // Random color
  const color = heartColors[Math.floor(Math.random() * heartColors.length)];
  
  heart.style.left = startX + '%';
  heart.style.top = startY + '%';
  heart.innerHTML = createHeartSVG(size, color);
  
  // Animation properties
  const duration = 4000 + Math.random() * 2000; // 4-6 seconds
  const endY = 75; // Near the girl
  const drift = (Math.random() - 0.5) * 15; // Horizontal drift
  const rotation = (Math.random() - 0.5) * 40;
  
  heartsContainer.appendChild(heart);
  
  // Animate floating
  let startTime = null;
  let isPopped = false;
  
  function animate(timestamp) {
    if (!startTime) startTime = timestamp;
    const elapsed = timestamp - startTime;
    const animProgress = Math.min(elapsed / duration, 1);
    
    if (isPopped) return; // Stop if popped
    
    // Easing - gentle float
    const easeProgress = 1 - Math.pow(1 - animProgress, 2);
    
    const currentY = startY + (endY - startY) * easeProgress;
    const currentX = startX + drift * Math.sin(animProgress * Math.PI * 2);
    const currentRotation = rotation * Math.sin(animProgress * Math.PI);
    
    // Scale: start small, grow to max, then shrink as it fades
    let scale;
    if (animProgress < 0.3) {
      scale = 0.3 + (animProgress / 0.3) * 0.7; // Grow from 0.3 to 1
    } else if (animProgress > 0.85) {
      scale = 1 - ((animProgress - 0.85) / 0.15) * 0.7; // Shrink from 1 to 0.3
    } else {
      scale = 1;
    }
    
    heart.style.top = currentY + '%';
    heart.style.left = currentX + '%';
    heart.style.transform = `rotate(${currentRotation}deg) scale(${scale})`;
    heart.style.opacity = animProgress < 0.9 ? 1 : 1 - ((animProgress - 0.9) / 0.1);
    
    if (animProgress < 1) {
      requestAnimationFrame(animate);
    } else {
      // Fade out animation when reaching the end
      heart.classList.add('faded');
      setTimeout(() => {
        if (heart.parentNode) {
          heart.remove();
        }
      }, 1000);
    }
  }
  
  requestAnimationFrame(animate);
  
  // Click to pop
  heart.addEventListener('click', () => {
    if (currentLetterIndex < message.length && !isPopped) {
      isPopped = true;
      popHeart(heart);
    }
  });
}

// Pop heart and reveal letter
function popHeart(heart) {
  if (heart.classList.contains('popped')) return;
  
  heart.classList.add('popped');
  
  // Create particle burst
  const rect = heart.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;
  
  // Sparkles
  for (let i = 0; i < 12; i++) {
    createParticle(centerX, centerY, 'sparkle');
  }
  
  // Heart fragments
  for (let i = 0; i < 8; i++) {
    createParticle(centerX, centerY, 'heart-fragment');
  }
  
  // Reveal letter
  const letter = message[currentLetterIndex];
  
  // Skip spaces (just increment)
  if (letter === ' ') {
    currentLetterIndex++;
    if (currentLetterIndex < message.length) {
      // Continue to next letter
      return;
    }
  } else {
    const pos = letterPositions[currentLetterIndex];
    
    const letterEl = document.createElement('div');
    letterEl.className = 'letter-revealed shimmer';
    letterEl.textContent = letter;
    letterEl.style.left = pos.x + '%';
    letterEl.style.top = pos.y + '%';
    
    document.body.appendChild(letterEl);
    
    currentLetterIndex++;
  }
  
  // Hide instruction after first pop
  if (currentLetterIndex === 1) {
    instruction.classList.add('hidden');
    setTimeout(() => {
      instruction.style.display = 'none';
    }, 500);
  }
  
  // All letters revealed
  if (currentLetterIndex >= message.length) {
    setTimeout(() => {
      celebrateComplete();
    }, 1000);
  }
}

// Create particle effect
function createParticle(x, y, type) {
  const particle = document.createElement('div');
  particle.className = `particle ${type}`;
  particle.style.left = x + 'px';
  particle.style.top = y + 'px';
  
  const angle = Math.random() * Math.PI * 2;
  const distance = 40 + Math.random() * 60;
  const endX = x + Math.cos(angle) * distance;
  const endY = y + Math.sin(angle) * distance;
  
  document.body.appendChild(particle);
  
  const duration = 800 + Math.random() * 400;
  
  particle.animate([
    { 
      left: x + 'px', 
      top: y + 'px', 
      opacity: 1,
      transform: 'scale(1) rotate(0deg)'
    },
    { 
      left: endX + 'px', 
      top: endY + 'px', 
      opacity: 0,
      transform: 'scale(0.3) rotate(360deg)'
    }
  ], {
    duration: duration,
    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
  });
  
  setTimeout(() => particle.remove(), duration);
}

// Celebration when complete
function celebrateComplete() {
  completionMessage.classList.add('show');
  
  // Create magical burst of hearts around the screen
  for (let i = 0; i < 40; i++) {
    setTimeout(() => {
      createCelebrationHeart();
    }, i * 60);
  }
  
  // Create cascading sparkles
  for (let i = 0; i < 50; i++) {
    setTimeout(() => {
      const x = Math.random() * window.innerWidth;
      const y = Math.random() * window.innerHeight * 0.5;
      createParticle(x, y, 'sparkle');
    }, i * 80);
  }
}

// Create celebration hearts
function createCelebrationHeart() {
  const heart = document.createElement('div');
  heart.className = 'heart';
  
  // Random position
  const startX = Math.random() * 100;
  const startY = Math.random() * 100;
  
  const size = 20 + Math.random() * 40;
  const color = heartColors[Math.floor(Math.random() * heartColors.length)];
  
  heart.style.left = startX + '%';
  heart.style.top = startY + '%';
  heart.innerHTML = createHeartSVG(size, color);
  heart.style.pointerEvents = 'none';
  
  heartsContainer.appendChild(heart);
  
  heart.animate([
    { 
      opacity: 0, 
      transform: 'scale(0) rotate(0deg)'
    },
    { 
      opacity: 1, 
      transform: 'scale(1.5) rotate(180deg)',
      offset: 0.5
    },
    { 
      opacity: 0, 
      transform: 'scale(0) rotate(360deg)'
    }
  ], {
    duration: 2500,
    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
  });
  
  setTimeout(() => heart.remove(), 2500);
}

// Generate hearts continuously
function startHeartGeneration() {
  createHeart();
  
  // Random interval between hearts
  const interval = 700 + Math.random() * 1000; // 0.7-1.7 seconds
  setTimeout(startHeartGeneration, interval);
}

// Start after a brief delay
setTimeout(startHeartGeneration, 1500);

// Add ambient sparkles around the boy's head
setInterval(() => {
  if (Math.random() > 0.6) {
    const x = window.innerWidth * (0.45 + Math.random() * 0.1); // Around boy's head area
    const y = window.innerHeight * (0.2 + Math.random() * 0.15);
    createParticle(x, y, 'sparkle');
  }
}, 800);
</script>

</body>
</html>
